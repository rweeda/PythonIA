<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Side‑by‑Side Teaching View (Instructions + Basthon)</title>
  <style>
    :root {
      --gutter: 10px;
      --left-min: 240px;
      --right-min: 320px;
    }
    * { box-sizing: border-box; }
    html, body {
      height: 100%;
      margin: 0;
      font-family: system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, sans-serif;
    }
    .topbar {
      display: flex;
      gap: 8px;
      align-items: center;
      padding: 10px;
      border-bottom: 1px solid #e5e5e5;
      background: #fafafa;
      position: sticky;
      top: 0;
      z-index: 5;
    }
    .topbar label { font-size: 14px; color: #333; }
    .topbar input[type="url"] {
      flex: 1;
      min-width: 200px;
      padding: 8px 10px;
      border: 1px solid #d0d0d0;
      border-radius: 8px;
      font-size: 14px;
    }
    .topbar button {
      padding: 8px 12px;
      border: 1px solid #c8c8c8;
      border-radius: 8px;
      background: white;
      cursor: pointer;
      font-size: 14px;
    }
    .topbar button:hover { background: #f3f3f3; }
    .topbar .hint {
      font-size: 12px;
      color: #666;
    }

    .wrap {
      display: grid;
      grid-template-columns: 1fr 8px 1fr;
      grid-template-rows: 1fr;
      height: calc(100% - 52px); /* account for topbar */
      min-height: 300px;
    }
    .pane {
      overflow: auto;
      min-width: 0; /* important for flex/grid content shrinking */
    }
    .left {
      min-width: var(--left-min);
      padding: 16px;
      background: #fff;
    }
    .left .section-title {
      margin-top: 0;
      font-size: 18px;
    }
    .left .note {
      font-size: 13px;
      color: #666;
      margin-bottom: 12px;
    }
    .left .content[contenteditable="true"] {
      border: 1px solid #e2e2e2;
      border-radius: 12px;
      padding: 14px;
      min-height: 200px;
      outline: none;
    }
    .left .content:focus {
      border-color: #bdbdbd;
      box-shadow: 0 0 0 3px rgba(0,0,0,0.04);
    }

    .gutter {
      width: 8px;
      cursor: col-resize;
      background: linear-gradient(90deg, #f2f2f2, #e9e9e9, #f2f2f2);
    }
    .gutter:hover { background: #e1e1e1; }

    .right {
      min-width: var(--right-min);
      background: #f7f7f7;
      display: flex;
      flex-direction: column;
    }
    .right .framewrap {
      position: relative;
      flex: 1;
      min-height: 200px;
    }
    iframe {
      position: absolute;
      inset: 0;
      width: 100%;
      height: 100%;
      border: none;
      background: #fff;
    }

    /* Small screens: stack vertically */
    @media (max-width: 900px) {
      .wrap {
        grid-template-columns: 1fr;
        grid-template-rows: auto 8px 60vh;
      }
      .gutter { cursor: row-resize; height: 8px; width: 100%; }
    }

    .footer {
      padding: 10px 12px;
      font-size: 12px;
      color: #777;
      text-align: center;
      border-top: 1px solid #eee;
      background: #fafafa;
    }
    code.kbd {
      background: #f2f2f2;
      padding: 2px 6px;
      border-radius: 6px;
      border: 1px solid #e2e2e2;
      font-family: ui-monospace, SFMono-Regular, Menlo, Consolas, monospace;
      font-size: 12px;
    }
  </style>
</head>
<body>
  <div class="topbar">
    <label for="nburl"><strong>Basthon notebook URL</strong></label>
    <input id="nburl" type="url" placeholder="https://basthon.informatica-actief.nl/?from=https://raw.githubusercontent.com/rweeda/PythonIA/main/H6/H6_IA_2.ipynb" />
    <button id="load">Load</button>
    <button id="remember">Remember</button>
    <span class="hint">Tip: Use a raw URL to your <code class="kbd">.ipynb</code> (e.g., GitHub raw or Gist raw).</span>
  </div>

  <div class="wrap" id="wrap">
    <section class="pane left">
      <h2 class="section-title">Instructies / Opdrachten</h2>
      <p class="note">
        Dit is een bewerkbaar tekstvak. Pas je uitleg aan en sla de pagina lokaal op.
        Je kunt hier ook afbeeldingen en opdrachten plaatsen.
      </p>
      <div id="content" class="content" contenteditable="true">
        <h3>Voorbeeld: Variabelen en SQLite</h3>
        <ol>
          <li>Schrijf een Python‑programma dat twee getallen optelt en het resultaat toont.</li>
          <li>Maak een SQLite‑database met een tabel <code>students(name TEXT, age INTEGER)</code>.</li>
          <li>Voeg 3 rijen toe en selecteer alle rijen.</li>
          <li>Experimenteer met <code>%%sql</code> magics als je Basthon‑SQL gebruikt.</li>
        </ol>
        <p><em>Tip:</em> In Basthon kun je vaak Python en SQLite combineren. Controleer de documentatie van jouw Basthon build.</p>
      </div>
    </section>

    <div class="gutter" id="gutter" title="Drag to resize"></div>

    <section class="pane right">
      <div class="framewrap">
        <iframe id="frame" src="about:blank" allow="clipboard-read; clipboard-write"></iframe>
      </div>
    </section>
  </div>

  <div class="footer">
    Side‑by‑side view • Drag the divider to resize • The notebook URL is stored in <code class="kbd">localStorage</code> when you click “Remember”.
  </div>

  <script>
    (function(){
      const frame = document.getElementById('frame');
      const nburl = document.getElementById('nburl');
      const loadBtn = document.getElementById('load');
      const rememberBtn = document.getElementById('remember');
      const wrap = document.getElementById('wrap');
      const gutter = document.getElementById('gutter');

      const BASTHON_PREFIX = "https://basthon.fr/notebook/?from=";

      // Load saved URL and widths
      const savedUrl = localStorage.getItem('basthon_nb_url');
      if (savedUrl) {
        nburl.value = savedUrl;
        frame.src = savedUrl;
      } else {
        // Helpful default: ask for a raw URL; if only a raw .ipynb is given, prefix Basthon.
        nburl.placeholder = BASTHON_PREFIX + "RAW_NOTEBOOK_URL";
      }

      const savedCols = localStorage.getItem('split_cols');
      if (savedCols) {
        try {
          const cols = JSON.parse(savedCols);
          if (Array.isArray(cols) && cols.length === 3) {
            wrap.style.gridTemplateColumns = cols.join(' ');
          }
        } catch(e){}
      }

      // Load button: if user pastes a raw .ipynb, wrap with Basthon prefix automatically
      loadBtn.addEventListener('click', () => {
        let url = nburl.value.trim();
        if (!url) return;
        if (url.endsWith('.ipynb') && !url.includes('basthon.fr/notebook/?from=')) {
          url = BASTHON_PREFIX + encodeURIComponent(url);
          nburl.value = url;
        }
        frame.src = url;
      });

      // Remember URL
      rememberBtn.addEventListener('click', () => {
        const url = nburl.value.trim();
        if (url) {
          localStorage.setItem('basthon_nb_url', url);
          // Also remember the left content
          localStorage.setItem('left_content_html', document.getElementById('content').innerHTML);
          alert('Saved! The URL and left‑pane content are stored in this browser.');
        }
      });

      // Restore left content if any
      const savedContent = localStorage.getItem('left_content_html');
      if (savedContent) {
        document.getElementById('content').innerHTML = savedContent;
      }

      // Drag to resize (horizontal on wide screens, vertical on small screens)
      let isDragging = false;
      let startPos = 0;
      let startCols = [];

      const isVertical = () => window.matchMedia('(max-width: 900px)').matches;

      const onDown = (e) => {
        isDragging = true;
        startPos = isVertical() ? (e.touches ? e.touches[0].clientY : e.clientY)
                                 : (e.touches ? e.touches[0].clientX : e.clientX);
        const style = getComputedStyle(wrap);
        startCols = isVertical()
          ? [style.gridTemplateRows.split(' ')[0], '8px', style.gridTemplateRows.split(' ')[2]]
          : [style.gridTemplateColumns.split(' ')[0], '8px', style.gridTemplateColumns.split(' ')[2]];
        document.body.style.userSelect = 'none';
      };
      const onMove = (e) => {
        if (!isDragging) return;
        const current = isVertical() ? (e.touches ? e.touches[0].clientY : e.clientY)
                                     : (e.touches ? e.touches[0].clientX : e.clientX);
        const delta = current - startPos;
        // Convert first/third tracks from px to fr by using pixel widths
        const rect = wrap.getBoundingClientRect();
        if (isVertical()) {
          const total = rect.height - 8;
          const topPx = Math.max(160, Math.min(total - 160, (wrap.children[0].getBoundingClientRect().height + delta)));
          const bottomPx = total - topPx;
          const newRows = [topPx + 'px', '8px', bottomPx + 'px'];
          wrap.style.gridTemplateRows = newRows.join(' ');
          localStorage.setItem('split_rows', JSON.stringify(newRows));
        } else {
          const total = rect.width - 8;
          const leftPx = Math.max(220, Math.min(total - 280, (wrap.children[0].getBoundingClientRect().width + delta)));
          const rightPx = total - leftPx;
          const newCols = [leftPx + 'px', '8px', rightPx + 'px'];
          wrap.style.gridTemplateColumns = newCols.join(' ');
          localStorage.setItem('split_cols', JSON.stringify(newCols));
        }
        startPos = current;
      };
      const onUp = () => {
        isDragging = false;
        document.body.style.userSelect = '';
      };

      gutter.addEventListener('mousedown', onDown);
      gutter.addEventListener('touchstart', onDown, {passive:true});
      window.addEventListener('mousemove', onMove);
      window.addEventListener('touchmove', onMove, {passive:false});
      window.addEventListener('mouseup', onUp);
      window.addEventListener('touchend', onUp);
    })();
  </script>
</body>
</html>
